> summary(lr_result)
Large data regression model: biglm(formula = formula, data = data, ...)
Sample size =  29328678
                   Coef    (95%     CI)     SE      p
(Intercept)     26.9112 24.1669 29.6554 1.3721 0.0000
Year2002        -2.9842 -3.0331 -2.9353 0.0245 0.0000
Year2003        -3.9025 -3.9508 -3.8543 0.0241 0.0000
Year2004        -1.2591 -1.3059 -1.2123 0.0234 0.0000
Year2005         0.1079  0.0586  0.1573 0.0247 0.0000
Year2006         1.5461  1.4961  1.5962 0.0250 0.0000
Year2007         2.9191  2.8693  2.9689 0.0249 0.0000
Year2008         1.4410  1.3904  1.4915 0.0253 0.0000
Month           -0.1297 -0.1446 -0.1148 0.0074 0.0000
DayofMonth       0.0109  0.0096  0.0122 0.0006 0.0000
DayOfWeek2      -2.1852 -2.2267 -2.1438 0.0207 0.0000
DayOfWeek3      -1.7130 -1.7544 -1.6716 0.0207 0.0000
DayOfWeek4       0.2509  0.2096  0.2923 0.0207 0.0000
DayOfWeek5       1.2105  1.1691  1.2518 0.0207 0.0000
DayOfWeek6      -2.1227 -2.1658 -2.0796 0.0215 0.0000
DayOfWeek7       0.4610  0.4191  0.5029 0.0210 0.0000
Distance         0.0002  0.0002  0.0002 0.0000 0.0000
TaxiIn           0.0213  0.0207  0.0219 0.0003 0.0000
TaxiOut          0.1681  0.1671  0.1692 0.0005 0.0000
TEMP.x          -0.0130 -0.0151 -0.0108 0.0011 0.0000
DEWP.x           0.0616  0.0596  0.0635 0.0010 0.0000
SLP.x           -0.0038 -0.0064 -0.0012 0.0013 0.0032
VISIB.x         -1.0202 -1.0305 -1.0099 0.0052 0.0000
WDSP.x           0.0344  0.0280  0.0408 0.0032 0.0000
MXSPD.x          0.2198  0.2158  0.2239 0.0020 0.0000
PRCP.x           0.8802  0.8423  0.9180 0.0189 0.0000
SNDP.x           0.5375  0.5234  0.5515 0.0070 0.0000
TEMP.y          -0.0140 -0.0161 -0.0118 0.0011 0.0000
DEWP.y           0.0561  0.0542  0.0581 0.0010 0.0000
SLP.y           -0.0117 -0.0143 -0.0091 0.0013 0.0000
VISIB.y         -0.9721 -0.9825 -0.9618 0.0052 0.0000
WDSP.y           0.0658  0.0594  0.0722 0.0032 0.0000
MXSPD.y          0.1376  0.1335  0.1417 0.0020 0.0000
PRCP.y           0.6372  0.5994  0.6750 0.0189 0.0000
SNDP.y           0.3104  0.2964  0.3243 0.0070 0.0000
UniqueCarrierAA  1.0533  0.8265  1.2800 0.1134 0.0000
UniqueCarrierAQ -0.2233 -0.6271  0.1805 0.2019 0.2687
UniqueCarrierAS  2.6812  2.4398  2.9226 0.1207 0.0000
UniqueCarrierB6  1.5639  1.3164  1.8114 0.1237 0.0000
UniqueCarrierCO -1.2798 -1.5123 -1.0472 0.1163 0.0000
UniqueCarrierDH  3.6215  3.3620  3.8810 0.1297 0.0000
UniqueCarrierDL -1.3752 -1.6020 -1.1484 0.1134 0.0000
UniqueCarrierEV  4.4432  4.1877  4.6987 0.1277 0.0000
UniqueCarrierF9 -2.2715 -2.5265 -2.0164 0.1275 0.0000
UniqueCarrierFL  0.9687  0.7335  1.2039 0.1176 0.0000
UniqueCarrierHA -1.8901 -2.2211 -1.5592 0.1655 0.0000
UniqueCarrierHP  2.4366  2.1993  2.6738 0.1186 0.0000
UniqueCarrierMQ  2.3021  2.0729  2.5313 0.1146 0.0000
UniqueCarrierNW -0.0392 -0.2625  0.1840 0.1116 0.7253
UniqueCarrierOH  2.7167  2.4793  2.9540 0.1187 0.0000
UniqueCarrierOO  1.0063  0.7708  1.2418 0.1178 0.0000
UniqueCarrierTW  0.2112 -0.0658  0.4883 0.1385 0.1273
UniqueCarrierTZ -0.1277 -0.4010  0.1456 0.1367 0.3502
UniqueCarrierUA  0.8272  0.5998  1.0545 0.1137 0.0000
UniqueCarrierUS -0.1745 -0.4015  0.0525 0.1135 0.1242
UniqueCarrierWN  4.7040  4.4786  4.9294 0.1127 0.0000
UniqueCarrierXE  0.4187  0.1851  0.6524 0.1168 0.0003
UniqueCarrierYV  5.8922  5.6382  6.1462 0.1270 0.0000
OriginANC        0.8887  0.6284  1.1489 0.1301 0.0000
OriginATL        4.2631  4.1136  4.4126 0.0748 0.0000
OriginAUS       -1.6777 -1.8621 -1.4933 0.0922 0.0000
OriginBDL       -0.6812 -0.8652 -0.4972 0.0920 0.0000
OriginBHM       -0.5675 -0.7818 -0.3533 0.1071 0.0000
OriginBNA        0.3620  0.1956  0.5283 0.0832 0.0000
OriginBOS        0.5310  0.3782  0.6837 0.0764 0.0000
OriginBUF       -1.0063 -1.2064 -0.8061 0.1001 0.0000
OriginBUR       -1.0313 -1.2432 -0.8194 0.1060 0.0000
OriginBWI        1.4129  1.2568  1.5690 0.0781 0.0000
OriginCLE       -1.6014 -1.7677 -1.4352 0.0831 0.0000
OriginCLT        2.1797  2.0206  2.3387 0.0795 0.0000
OriginCMH       -0.5505 -0.7298 -0.3712 0.0897 0.0000
OriginCVG        0.1583 -0.0062  0.3227 0.0822 0.0542
OriginDCA       -1.7653 -1.9231 -1.6074 0.0789 0.0000
OriginDEN        2.0199  1.8718  2.1680 0.0740 0.0000
OriginDFW        2.0486  1.8998  2.1974 0.0744 0.0000
OriginDTW        1.4797  1.3213  1.6382 0.0792 0.0000
OriginEWR        3.6130  3.4574  3.7685 0.0778 0.0000
OriginHNL       -3.3081 -3.5372 -3.0790 0.1145 0.0000
OriginHOU        0.6916  0.4486  0.9346 0.1215 0.0000
OriginIAD        1.3795  1.2168  1.5421 0.0813 0.0000
OriginIAH        0.4240  0.2632  0.5848 0.0804 0.0000
OriginIND       -1.6811 -1.8591 -1.5031 0.0890 0.0000
OriginJAX       -0.6655 -0.8620 -0.4690 0.0983 0.0000
OriginJFK        1.0093  0.8437  1.1748 0.0828 0.0000
OriginLAS        4.0498  3.9037  4.1960 0.0731 0.0000
OriginLAX       -0.4880 -0.6344 -0.3416 0.0732 0.0000
OriginLGA        0.3405  0.1863  0.4946 0.0771 0.0000
OriginMCI       -1.3056 -1.4718 -1.1393 0.0831 0.0000
OriginMCO       -0.1213 -0.2793  0.0368 0.0790 0.1248
OriginMDW        1.9117  1.7515  2.0718 0.0801 0.0000
OriginMIA        2.6844  2.5130  2.8557 0.0857 0.0000
OriginMKE       -0.9718 -1.1771 -0.7664 0.1027 0.0000
OriginMSP       -0.0473 -0.2062  0.1117 0.0795 0.5519
OriginMSY       -0.9196 -1.1016 -0.7377 0.0910 0.0000
OriginOAK       -0.3626 -0.5415 -0.1837 0.0894 0.0001
OriginOGG       -4.6309 -4.9061 -4.3557 0.1376 0.0000
OriginOMA       -1.2787 -1.4823 -1.0751 0.1018 0.0000
OriginORD        5.1819  5.0371  5.3268 0.0724 0.0000
OriginPBI       -0.3190 -0.5205 -0.1175 0.1007 0.0015
OriginPDX       -0.1033 -0.2763  0.0698 0.0865 0.2327
OriginPHL        4.3289  4.1734  4.4844 0.0778 0.0000
OriginPHX        3.2323  3.0856  3.3790 0.0734 0.0000
OriginPIT       -0.0689 -0.2361  0.0983 0.0836 0.4099
OriginRDU        0.5524  0.3853  0.7195 0.0836 0.0000
OriginRSW       -0.1582 -0.3903  0.0738 0.1160 0.1727
OriginSAN       -0.8260 -0.9827 -0.6693 0.0783 0.0000
OriginSAT       -0.6075 -0.7961 -0.4190 0.0943 0.0000
OriginSEA        1.8048  1.6442  1.9654 0.0803 0.0000
OriginSFO        0.3822  0.2259  0.5384 0.0781 0.0000
OriginSJC       -0.0351 -0.2008  0.1307 0.0829 0.6720
OriginSLC       -0.0570 -0.2133  0.0992 0.0781 0.4653
OriginSMF        0.9066  0.7188  1.0943 0.0939 0.0000
OriginSNA       -1.9418 -2.1288 -1.7549 0.0935 0.0000
OriginSTL       -0.7237 -0.8832 -0.5643 0.0797 0.0000
OriginTPA        0.1763  0.0100  0.3426 0.0831 0.0340
DestANC          4.0775  3.8174  4.3377 0.1301 0.0000
DestATL          0.8680  0.7182  1.0178 0.0749 0.0000
DestAUS         -1.4337 -1.6184 -1.2491 0.0923 0.0000
DestBDL         -1.0350 -1.2192 -0.8507 0.0921 0.0000
DestBHM         -1.5668 -1.7813 -1.3524 0.1072 0.0000
DestBNA         -1.3062 -1.4729 -1.1396 0.0833 0.0000
DestBOS         -0.5644 -0.7175 -0.4114 0.0765 0.0000
DestBUF         -1.2612 -1.4614 -1.0610 0.1001 0.0000
DestBUR         -0.7761 -0.9882 -0.5641 0.1060 0.0000
DestBWI         -0.8590 -1.0154 -0.7025 0.0782 0.0000
DestCLE         -2.8177 -2.9843 -2.6511 0.0833 0.0000
DestCLT         -2.4245 -2.5838 -2.2652 0.0796 0.0000
DestCMH         -1.3099 -1.4895 -1.1304 0.0898 0.0000
DestCVG         -2.9897 -3.1545 -2.8249 0.0824 0.0000
DestDCA         -3.2247 -3.3828 -3.0665 0.0791 0.0000
DestDEN         -1.2288 -1.3773 -1.0803 0.0743 0.0000
DestDFW         -1.3147 -1.4639 -1.1655 0.0746 0.0000
DestDTW         -2.5764 -2.7351 -2.4177 0.0793 0.0000
DestEWR          5.6416  5.4862  5.7971 0.0777 0.0000
DestHNL         -0.1321 -0.3615  0.0973 0.1147 0.2494
DestHOU         -2.2759 -2.5190 -2.0328 0.1215 0.0000
DestIAD         -1.4035 -1.5664 -1.2406 0.0815 0.0000
DestIAH         -2.7197 -2.8808 -2.5587 0.0805 0.0000
DestIND         -2.4441 -2.6224 -2.2658 0.0891 0.0000
DestJAX         -1.8498 -2.0465 -1.6531 0.0984 0.0000
DestJFK          1.6181  1.4531  1.7830 0.0825 0.0000
DestLAS          2.2171  2.0707  2.3636 0.0732 0.0000
DestLAX         -1.3391 -1.4859 -1.1923 0.0734 0.0000
DestLGA          1.6370  1.4831  1.7909 0.0770 0.0000
DestMCI         -1.8137 -1.9803 -1.6472 0.0833 0.0000
DestMCO         -1.7436 -1.9021 -1.5852 0.0792 0.0000
DestMDW         -2.0449 -2.2055 -1.8844 0.0803 0.0000
DestMIA         -0.7771 -0.9487 -0.6055 0.0858 0.0000
DestMKE         -1.8662 -2.0717 -1.6608 0.1027 0.0000
DestMSP         -2.2342 -2.3935 -2.0749 0.0796 0.0000
DestMSY         -2.5722 -2.7544 -2.3900 0.0911 0.0000
DestOAK         -0.6289 -0.8082 -0.4497 0.0896 0.0000
DestOGG         -2.7268 -2.9987 -2.4549 0.1359 0.0000
DestOMA         -1.4535 -1.6572 -1.2498 0.1019 0.0000
DestORD          2.2726  2.1275  2.4178 0.0726 0.0000
DestPBI         -1.5404 -1.7421 -1.3387 0.1009 0.0000
DestPDX          0.5232  0.3498  0.6966 0.0867 0.0000
DestPHL          1.2969  1.1415  1.4524 0.0777 0.0000
DestPHX          0.9190  0.7719  1.0661 0.0736 0.0000
DestPIT         -2.0958 -2.2635 -1.9281 0.0839 0.0000
DestRDU         -0.9422 -1.1097 -0.7747 0.0837 0.0000
DestRSW         -2.2185 -2.4507 -1.9862 0.1161 0.0000
DestSAN         -0.9566 -1.1136 -0.7995 0.0785 0.0000
DestSAT         -1.2323 -1.4208 -1.0438 0.0942 0.0000
DestSEA          1.2575  1.0965  1.4185 0.0805 0.0000
DestSFO          1.4111  1.2545  1.5677 0.0783 0.0000
DestSJC         -0.1386 -0.3047  0.0274 0.0830 0.0950
DestSLC         -0.2606 -0.4171 -0.1041 0.0783 0.0009
DestSMF          0.9052  0.7172  1.0932 0.0940 0.0000
DestSNA         -3.3171 -3.5043 -3.1299 0.0936 0.0000
DestSTL         -2.2221 -2.3819 -2.0622 0.0799 0.0000
DestTPA         -1.0260 -1.1926 -0.8594 0.0833 0.0000
Fog.x1          -0.3701 -0.4078 -0.3324 0.0188 0.0000
Rain.x1          1.3883  1.3565  1.4201 0.0159 0.0000
Snow.x1          2.4182  2.3572  2.4792 0.0305 0.0000
Hail.x1          3.5240  3.2633  3.7848 0.1304 0.0000
Thunder.x1       5.4897  5.4432  5.5362 0.0232 0.0000
Tornado.x1       3.1766  2.5977  3.7555 0.2895 0.0000
Fog.y1          -0.6610 -0.6987 -0.6233 0.0188 0.0000
Rain.y1          1.1598  1.1280  1.1916 0.0159 0.0000
Snow.y1          1.5833  1.5224  1.6442 0.0305 0.0000
Hail.y1          1.2691  1.0083  1.5299 0.1304 0.0000
Thunder.y1       3.6093  3.5628  3.6557 0.0232 0.0000
Tornado.y1       2.7320  2.1528  3.3113 0.2896 0.0000
seasonspring    -0.5250 -0.6168 -0.4332 0.0459 0.0000
seasonsummer    -0.3663 -0.4271 -0.3055 0.0304 0.0000
seasonwinter     0.8322  0.7037  0.9606 0.0642 0.0000
> stats::AIC(lr_result)
[1] 27072643730
> #vif(lr_result)
> #ols_step_backward_aic(lr_result, details = TRUE)
> #dat = filter(list_file, Cancelled==0|Diverted==0)
> #dat = select(dat,-c(key2, key, DepTime, STN....x, YEARMODA.x, STN....y, YEARMODA.y,     #reason 1
> #                        CRSDepTime, ArrTime, CRSArrTime, ActualElapsedTime, CRSElapsedTime, #reason 1
> #                        Cancelled, CancellationCode, Diverted, #reason 2
> #                        CarrierDelay, WeatherDelay, NASDelay, SecurityDelay, LateAircraftDelay, STP.x, STP.y, GUST.x, GUST.y)) ##reason 3
> #bigreg_slr <- biglm.big.matrix(DepDelay ~ ., data = dat)
> #vif(bigreg_slr)
> #summary(bigreg_slr)
> #summary(dat)
> #cor(dat)
> #write.csv(dat,file="~/final/datacleaning.csv")
> v = vcov(lr_result)
> assign <- lr_result$assign
> if (names(coefficients(lr_result)[1]) == "(Intercept)") {
+   v <- v[-1, -1]
+   assign <- assign[-1]
+ }
> terms <- labels(terms(lr_result))
> n.terms <- length(terms)
> R <- cov2cor(v)
> detR <- det(R)
> result <- matrix(0, n.terms, 3)
> rownames(result) <- terms
> colnames(result) <- c("GVIF", "Df", "GVIF^(1/(2*Df))")
> for (term in 1:n.terms) {
+   subs <- which(assign == term)
+   result[term, 1] <- det(as.matrix(R[subs, subs])) *
+     det(as.matrix(R[-subs, -subs])) / detR
+   result[term, 2] <- length(subs)
+ }
> if (all(result[, 2] == 1)) result <- result[, 1] else result[, 3] <- result[, 1]^(1/(2 * result[, 2]))
>
>
> result
                     GVIF Df GVIF^(1/(2*Df))
Year             1.911009  7        1.047346
Month           17.202415  1        4.147579
DayofMonth       1.001500  1        1.000750
DayOfWeek        1.010625  6        1.000881
Distance         1.430691  1        1.196115
TaxiIn           1.024763  1        1.012306
TaxiOut          1.215129  1        1.102329
TEMP.x          10.767510  1        3.281388
DEWP.x           9.316479  1        3.052291
SLP.x            2.112759  1        1.453533
VISIB.x          1.918351  1        1.385046
WDSP.x           3.218052  1        1.793893
MXSPD.x          3.103375  1        1.761640
PRCP.x           1.204535  1        1.097513
SNDP.x           1.277779  1        1.130389
TEMP.y          10.770618  1        3.281862
DEWP.y           9.316887  1        3.052358
SLP.y            2.112546  1        1.453460
VISIB.y          1.917689  1        1.384807
WDSP.y           3.221343  1        1.794810
MXSPD.y          3.105368  1        1.762205
PRCP.y           1.204596  1        1.097541
SNDP.y           1.276976  1        1.130033
UniqueCarrier 3579.291850 23        1.194693
Origin        2698.009667 57        1.071758
Dest          2456.226247 57        1.070876
Fog.x            1.842536  1        1.357401
Rain.x           1.751565  1        1.323467
Snow.x           1.461406  1        1.208886
Hail.x           1.038345  1        1.018992
Thunder.x        1.567696  1        1.252077
Tornado.x        1.003095  1        1.001546
Fog.y            1.842871  1        1.357524
Rain.y           1.751002  1        1.323254
Snow.y           1.458350  1        1.207622
Hail.y           1.038321  1        1.018980
Thunder.y        1.565019  1        1.251007
Tornado.y        1.003075  1        1.001536
season          44.763243  3        1.884315
